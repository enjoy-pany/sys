{"version":3,"sources":["webpack:///./src/page/canvasDemo/tool/audioTool.js","webpack:///src/page/canvasDemo/drawAudio.vue","webpack:///./src/page/canvasDemo/drawAudio.vue?756c","webpack:///./src/page/canvasDemo/drawAudio.vue"],"names":["audioTool","loadFileBuffer","file","fn","window","AudioContext","webkitAudioContext","mozAudioContext","msAudioContext","audioContext","e","Console","log","length","fr","FileReader","onload","er","fileResult","target","result","decodeAudioData","buffer","bufferArr","getChannelData","console","readAsArrayBuffer","getTime","x","totalTime","svgOper_biaozhu_v3","totalWidth","Number","toFixed","getWidth","time","drawAudio","data","canvas","rectArr","methods","handleFileChange","event","_this","this","files","f32Arr","Float32Array","i","drawPath","handleMouseWheel","handleMouseDown","preventDefault","windowToCanvas","y","handleMouseUp","onmousemove","onmouseup","components","mounted","document","getElementById","canvasTool","canvasDemo_drawAudio","render","_vm","_h","$createElement","_c","_self","attrs","type","name","on","change","_v","click","$event","seleBtn","staticClass","width","height","id","mousedown","mouseup","mousewheel","staticRenderFns","Component","__webpack_require__","normalizeComponent","ssrContext","__webpack_exports__"],"mappings":"sHA0DAA,GArDIC,eALa,SAKEC,EAAMC,GACjBC,OAAOC,aAAeD,OAAOC,cAAgBD,OAAOE,oBAAsBF,OAAOG,iBAAmBH,OAAOI,eAC3G,IAAIC,EAAa,IAAIL,OAAOC,aAC5B,IACQI,EAAe,IAAIL,OAAOC,aAChC,MAAOK,GACLC,QAAQC,IAAI,+CAGhB,GAAoB,IAAhBV,EAAKW,OAAc,CACnB,IAAIC,EAAK,IAAIC,WACbD,EAAGE,OAAS,SAASC,GACjB,IAAIC,EAAaD,EAAGE,OAAOC,OAE3BX,EAAaY,gBAAgBH,EAAY,SAASI,GACjD,IAAIC,EAAYD,EAAOE,eAAe,GACnCrB,EAAGoB,IACJ,SAASb,GAERe,QAAQb,IAAI,mBAGpBE,EAAGY,kBAAkBxB,KAO7ByB,QAlCa,SAkCLC,GACJ,IAAIC,EAAYC,mBAAmBD,UAKnC,OADYD,GAHKE,mBAAmBC,YACpCF,EAAiD,IAArCG,OAAOA,OAAOH,GAAWI,QAAQ,MAEnB,KAAMA,QAAQ,GAC5B,GAQhBC,SAhDa,SAgDJC,GACL,IAAIN,EAAYC,mBAAmBD,UAMnC,OADmB,IAAPM,GAJKL,mBAAmBC,YAEpCF,EAAyC,IAA7BG,OAAOH,GAAWI,QAAQ,KAGzB,IChCrBG,GACAC,KADA,WAEA,OACAC,OAAA,KACAC,aAGAC,SACAC,iBADA,SACAC,GAAA,IAAAC,EAAAC,KACA5C,EAAAC,eAAAyC,EAAAvB,OAAA0B,MAAA,YAAAtB,GACA,IAAAuB,EAAA,IAAAC,aAAAxB,EAAAV,OAAA,KACA,QAAAmC,KAAAF,EACAA,EAAAE,GAAAzB,EAAA,IAAAyB,GAEAL,EAAAL,OAAAW,SAAAH,EAAA,gBAGAI,iBAVA,SAUAR,KAGAS,gBAbA,SAaAT,GACAA,EAAAU,iBACAR,KAAAN,OAAAe,eAAAX,EAAAd,EAAAc,EAAAY,IAGAC,cAlBA,SAkBAb,GACAE,KAAAN,cAAAkB,YAAA,KACAZ,KAAAN,cAAAmB,UAAA,OAGAC,cAEAC,QAhCA,WAiCA,IAAArB,EAAAsB,SAAAC,eAAA,UAEAjB,KAAAN,OAAA,IAAAwB,EAAA,EAAAxB,KCvDAyB,GADiBC,OAFjB,WAA0B,IAAAC,EAAArB,KAAasB,EAAAD,EAAAE,eAA0BC,EAAAH,EAAAI,MAAAD,IAAAF,EAAwB,OAAAE,EAAA,OAAAA,EAAA,UAAAA,EAAA,SAA0CE,OAAOC,KAAA,OAAAC,KAAA,IAAwBC,IAAKC,OAAAT,EAAAxB,oBAA+BwB,EAAAU,GAAA,KAAAP,EAAA,aAAAH,EAAAU,GAAA,cAAAV,EAAAU,GAAA,KAAAP,EAAA,aAA+EE,OAAOC,KAAA,WAAiBE,IAAKG,MAAA,SAAAC,GAAyBZ,EAAAa,SAAAb,EAAAa,YAA2Bb,EAAAU,GAAA,YAAAV,EAAAU,GAAA,KAAAP,EAAA,aAAAH,EAAAU,GAAA,kBAAAV,EAAAU,GAAA,KAAAP,EAAA,OAAgGW,YAAA,cAAwBX,EAAA,UAAeE,OAAOU,MAAA,OAAAC,OAAA,MAAAC,GAAA,UAA4CT,IAAKU,UAAAlB,EAAAd,gBAAAiC,QAAAnB,EAAAV,cAAA8B,WAAApB,EAAAf,oBAA+Fe,EAAAU,GAAA,yDAEnnBW,oBCCjB,IAcAC,EAdAC,EAAA,OAcAC,CACArD,EACA2B,GATA,EAVA,SAAA2B,GACAF,EAAA,SAaA,kBAEA,MAUAG,EAAA,QAAAJ,EAAA","file":"static/js/12.f7c298d374ace428e4b9.js","sourcesContent":["const WebAudio = {\n\t/*\n    * 读取buffer方法\n    * file: file文件\n    */\n    loadFileBuffer(file, fn) {\n        window.AudioContext = window.AudioContext || window.webkitAudioContext || window.mozAudioContext || window.msAudioContext;\n        var audioContext=new window.AudioContext();\n        try {\n            var audioContext = new window.AudioContext();\n        } catch (e) {\n            Console.log('!Your browser does not support AudioContext');\n        }\n\n        if (file.length !== 0) {\n            var fr = new FileReader();\n            fr.onload = function(er) {\n                var fileResult = er.target.result;\n                //解码成功则调用此函数，参数buffer为解码后得到的结果\n                audioContext.decodeAudioData(fileResult, function(buffer) {\n                \tvar bufferArr = buffer.getChannelData(0)\n                    fn(bufferArr)\n                }, function(e) { \n                    //这个是解码失败会调用的函数\n                    console.log(\"!哎玛，文件解码失败:(\");\n                });\n            }\n            fr.readAsArrayBuffer(file);\n        };\n    },\n\t/**\n     * getTime：通过宽度获取时间\n     * x:宽度\n     */\n    getTime(x){\n        let totalTime = svgOper_biaozhu_v3.totalTime;\n        let totalWidth = svgOper_biaozhu_v3.totalWidth;\n        totalTime = Number(Number(totalTime).toFixed(2))*1000;\n        let unitWidth = (totalWidth/totalTime);\n        let time = (x / unitWidth/1000).toFixed(3);\n        return time-0;\n\n    },\n\n    /**\n     * getWidth：通过时间获取宽度\n     * time:时间\n     */\n    getWidth(time){\n        let totalTime = svgOper_biaozhu_v3.totalTime;\n        let totalWidth = svgOper_biaozhu_v3.totalWidth;\n\n        totalTime = Number(totalTime).toFixed(2)*1000;\n        let unitWidth = (totalWidth/totalTime);\n        let width = time * 1000 * unitWidth\n        return width-0;\n    },\n}\nexport default WebAudio\n\n\n// WEBPACK FOOTER //\n// ./src/page/canvasDemo/tool/audioTool.js","<template>\n<div>\n    <el-row>\n        <!-- <el-input type=\"file\" @change=\"handleFileChange\">本地上传方式</el-input> -->\n        <input type=\"file\" name=\"\" @change=\"handleFileChange\">\n        <el-button>http请求方式</el-button>\n        <el-button type=\"primary\" @click=\"seleBtn=!seleBtn\">绘制完整波谱</el-button>\n        <el-button>边播放边绘制波谱</el-button>\n    </el-row>\n    <div class=\"audioWrap\">\n        <canvas width=\"1000\" height=\"500\" id=\"canvas\" \n            @mousedown=\"handleMouseDown\" \n            @mouseup=\"handleMouseUp\"\n            @mousewheel=\"handleMouseWheel\">\n            canvas not supported\n        </canvas>\n    </div>\n</div>\n</template>\n<script>\nimport { Canvas } from './tool/canvasTool.js';\nimport WebAudio from './tool/audioTool.js';\n\nexport default {\n    data() {\n        return {\n        \tcanvas: null, //自定义canvas类\n        \trectArr: [], //矩形框数据集\n        }\n    },\n    methods: {\n        handleFileChange(event) {\n            WebAudio.loadFileBuffer(event.target.files[0],(bufferArr)=> {\n                let f32Arr = new Float32Array(bufferArr.length/500)\n                for( let i in f32Arr) {\n                    f32Arr[i] = bufferArr[i*500]\n                }\n                this.canvas.drawPath(f32Arr,1,'green',1)\n            })\n        },\n    \thandleMouseWheel(event) {\n\n    \t},\n    \thandleMouseDown(event) {\n            event.preventDefault();\n            var loc = this.canvas.windowToCanvas(event.x, event.y);\n            \n    \t},\n    \thandleMouseUp(event) {\n    \t\tthis.canvas.canvas.onmousemove = null;\n            this.canvas.canvas.onmouseup = null;\n    \t}\n    },\n    components: {\n    },\n    mounted() {\n    \tconst canvas = document.getElementById('canvas');\n        const that = this;\n        this.canvas = new Canvas(canvas);\n    }\n}\n</script>\n<style lang=\"less\" scoped>\n    .audioWrap {\n        width: 100%;\n        height: 100%;\n        overflow: auto;\n        #canvas{\n            background: #fff;\n            cursor: pointer;\n            margin-left: 10px;\n            margin-top: 10px;\n            box-shadow: 4px 4px 8px rgba(0,0,0,0.5);\n        }   \n    }\n\t\n</style>\n\n\n\n// WEBPACK FOOTER //\n// src/page/canvasDemo/drawAudio.vue","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('div',[_c('el-row',[_c('input',{attrs:{\"type\":\"file\",\"name\":\"\"},on:{\"change\":_vm.handleFileChange}}),_vm._v(\" \"),_c('el-button',[_vm._v(\"http请求方式\")]),_vm._v(\" \"),_c('el-button',{attrs:{\"type\":\"primary\"},on:{\"click\":function($event){_vm.seleBtn=!_vm.seleBtn}}},[_vm._v(\"绘制完整波谱\")]),_vm._v(\" \"),_c('el-button',[_vm._v(\"边播放边绘制波谱\")])],1),_vm._v(\" \"),_c('div',{staticClass:\"audioWrap\"},[_c('canvas',{attrs:{\"width\":\"1000\",\"height\":\"500\",\"id\":\"canvas\"},on:{\"mousedown\":_vm.handleMouseDown,\"mouseup\":_vm.handleMouseUp,\"mousewheel\":_vm.handleMouseWheel}},[_vm._v(\"\\n            canvas not supported\\n        \")])])],1)}\nvar staticRenderFns = []\nvar esExports = { render: render, staticRenderFns: staticRenderFns }\nexport default esExports\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./node_modules/vue-loader/lib/template-compiler?{\"id\":\"data-v-4c293bfa\",\"hasScoped\":true,\"transformToRequire\":{\"video\":[\"src\",\"poster\"],\"source\":\"src\",\"img\":\"src\",\"image\":\"xlink:href\"},\"buble\":{\"transforms\":{}}}!./node_modules/vue-loader/lib/selector.js?type=template&index=0!./src/page/canvasDemo/drawAudio.vue\n// module id = null\n// module chunks = ","function injectStyle (ssrContext) {\n  require(\"!!../../../node_modules/extract-text-webpack-plugin/dist/loader.js?{\\\"omit\\\":1,\\\"remove\\\":true}!vue-style-loader!css-loader?{\\\"sourceMap\\\":true}!../../../node_modules/vue-loader/lib/style-compiler/index?{\\\"vue\\\":true,\\\"id\\\":\\\"data-v-4c293bfa\\\",\\\"scoped\\\":true,\\\"hasInlineConfig\\\":false}!less-loader?{\\\"sourceMap\\\":true}!../../../node_modules/vue-loader/lib/selector?type=styles&index=0!./drawAudio.vue\")\n}\nvar normalizeComponent = require(\"!../../../node_modules/vue-loader/lib/component-normalizer\")\n/* script */\nexport * from \"!!babel-loader!../../../node_modules/vue-loader/lib/selector?type=script&index=0!./drawAudio.vue\"\nimport __vue_script__ from \"!!babel-loader!../../../node_modules/vue-loader/lib/selector?type=script&index=0!./drawAudio.vue\"\n/* template */\nimport __vue_template__ from \"!!../../../node_modules/vue-loader/lib/template-compiler/index?{\\\"id\\\":\\\"data-v-4c293bfa\\\",\\\"hasScoped\\\":true,\\\"transformToRequire\\\":{\\\"video\\\":[\\\"src\\\",\\\"poster\\\"],\\\"source\\\":\\\"src\\\",\\\"img\\\":\\\"src\\\",\\\"image\\\":\\\"xlink:href\\\"},\\\"buble\\\":{\\\"transforms\\\":{}}}!../../../node_modules/vue-loader/lib/selector?type=template&index=0!./drawAudio.vue\"\n/* template functional */\nvar __vue_template_functional__ = false\n/* styles */\nvar __vue_styles__ = injectStyle\n/* scopeId */\nvar __vue_scopeId__ = \"data-v-4c293bfa\"\n/* moduleIdentifier (server only) */\nvar __vue_module_identifier__ = null\nvar Component = normalizeComponent(\n  __vue_script__,\n  __vue_template__,\n  __vue_template_functional__,\n  __vue_styles__,\n  __vue_scopeId__,\n  __vue_module_identifier__\n)\n\nexport default Component.exports\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./src/page/canvasDemo/drawAudio.vue\n// module id = null\n// module chunks = "],"sourceRoot":""}